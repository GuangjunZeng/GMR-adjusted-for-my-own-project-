# æ‰¹é‡PKLåˆ°NPZè½¬æ¢å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ¯ **åŠŸèƒ½ç‰¹ç‚¹**

åŸºäºåŸå§‹ `29dof_pkl_to_npz.py` ä»£ç ï¼Œå®Œå…¨ä¿æŒåŸæœ‰é€»è¾‘ï¼Œæ–°å¢æ‰¹é‡å¤„ç†åŠŸèƒ½ï¼š

- âœ… **å®Œå…¨ä¿æŒåŸä»£ç ç»“æ„**ï¼šæ‰€æœ‰è½¬æ¢é€»è¾‘ä¸åŸå§‹ä»£ç ä¸€è‡´
- âœ… **æ™ºèƒ½è·³è¿‡å·²å­˜åœ¨æ–‡ä»¶**ï¼šé¿å…é‡å¤è½¬æ¢
- âœ… **æ‰¹é‡å¤„ç†**ï¼šä¸€æ¬¡æ€§å¤„ç†æ•´ä¸ªç›®å½•
- âœ… **è¯¦ç»†è¿›åº¦æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºå¤„ç†çŠ¶æ€
- âœ… **ç»Ÿè®¡æŠ¥å‘Š**ï¼šè½¬æ¢å®Œæˆåæ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡

## ğŸš€ **ä½¿ç”¨æ–¹æ³•**

### åŸºæœ¬ç”¨æ³•
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir /path/to/pkl/files \
  --output-dir /path/to/output/npz/files \
  --include-base
```

### å®Œæ•´å‚æ•°
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir /path/to/pkl/files \
  --output-dir /path/to/output/npz/files \
  --mjcf /path/to/model.xml \
  --include-base \
  --force
```

## ğŸ“‹ **å‚æ•°è¯´æ˜**

| å‚æ•° | å¿…éœ€ | è¯´æ˜ |
|------|------|------|
| `--pkl-dir` | âœ… | PKLæ–‡ä»¶æ‰€åœ¨ç›®å½• |
| `--output-dir` | âœ… | NPZæ–‡ä»¶è¾“å‡ºç›®å½• |
| `--mjcf` | âŒ | MJCF/XMLæ–‡ä»¶è·¯å¾„ï¼ˆæ¨èï¼‰ |
| `--include-base` | âŒ | åŒ…å«æ ¹ä½ç½®å’Œå§¿æ€æ•°æ® |
| `--force` | âŒ | å¼ºåˆ¶é‡æ–°è½¬æ¢å·²å­˜åœ¨çš„æ–‡ä»¶ |

## ğŸ” **æ™ºèƒ½è·³è¿‡æœºåˆ¶**

### æ£€æŸ¥é€»è¾‘
1. è¯»å–PKLæ–‡ä»¶åï¼ˆå¦‚ï¼š`000000.pkl`ï¼‰
2. ç”Ÿæˆå¯¹åº”NPZæ–‡ä»¶åï¼ˆå¦‚ï¼š`000000.npz`ï¼‰
3. æ£€æŸ¥è¾“å‡ºç›®å½•ä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥NPZæ–‡ä»¶
4. å¦‚æœå­˜åœ¨ä¸”æœªä½¿ç”¨ `--force`ï¼Œåˆ™è·³è¿‡è½¬æ¢

### è·³è¿‡ç¤ºä¾‹
```
[SKIP] 000000.pkl -> 000000.npz (å·²å­˜åœ¨)
[SKIP] 000001.pkl -> 000001.npz (å·²å­˜åœ¨)
```

## ğŸ“Š **è¾“å‡ºç¤ºä¾‹**

### å¤„ç†è¿‡ç¨‹
```
ğŸš€ å¼€å§‹æ‰¹é‡è½¬æ¢PKLåˆ°NPZ...
ğŸ“ PKLç›®å½•: /path/to/pkl/files
ğŸ“ è¾“å‡ºç›®å½•: /path/to/output/npz/files
ğŸ”§ åŒ…å«åŸºç¡€æ•°æ®: True
ğŸ”„ å¼ºåˆ¶é‡æ–°è½¬æ¢: False

[INFO] æœªæä¾› --mjcf,å°†å‡å®š pkl çš„åˆ—é¡ºåºå·²ç»ä¸ç›®æ ‡é¡ºåºä¸€è‡´ï¼ˆä¸é‡æ’ï¼‰ã€‚

ğŸ“‹ æ‰¾åˆ° 5 ä¸ªPKLæ–‡ä»¶

[1/5] å¤„ç†: 000000.pkl
[PROCESS] å¤„ç†: 000000.pkl
[OK] ä¿å­˜è‡³: /path/to/output/npz/files/000000.npz
     å½¢çŠ¶: (131, 36)
     åˆ—æ•°: 7+29
     ç²¾åº¦: float64
     åŒ…å«æ•°æ®: ['joints', 'joint_names', 'root_pos', 'root_quat', 'full_data', 'num_frames', 'num_joints', 'include_base']

[2/5] å¤„ç†: 000001.pkl
[SKIP] è¾“å‡ºæ–‡ä»¶å·²å­˜åœ¨: 000001.npz

[3/5] å¤„ç†: 000002.pkl
[PROCESS] å¤„ç†: 000002.pkl
[OK] ä¿å­˜è‡³: /path/to/output/npz/files/000002.npz
...
```

### å®Œæˆç»Ÿè®¡
```
============================================================
ğŸ“Š æ‰¹é‡è½¬æ¢å®Œæˆï¼
============================================================
âœ… æˆåŠŸè½¬æ¢: 3 ä¸ªæ–‡ä»¶
â­ï¸  è·³è¿‡æ–‡ä»¶: 2 ä¸ªæ–‡ä»¶
âŒ è½¬æ¢å¤±è´¥: 0 ä¸ªæ–‡ä»¶
ğŸ“ è¾“å‡ºç›®å½•: /path/to/output/npz/files

ğŸ‰ æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆï¼
```

## ğŸ’¡ **ä½¿ç”¨åœºæ™¯**

### 1. é¦–æ¬¡æ‰¹é‡è½¬æ¢
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir ./test_retarget_npz2pkl \
  --output-dir ./npz_output \
  --include-base
```

### 2. å¢é‡è½¬æ¢ï¼ˆè·³è¿‡å·²å­˜åœ¨ï¼‰
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir ./test_retarget_npz2pkl \
  --output-dir ./npz_output \
  --include-base
```

### 3. å¼ºåˆ¶é‡æ–°è½¬æ¢
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir ./test_retarget_npz2pkl \
  --output-dir ./npz_output \
  --include-base \
  --force
```

### 4. ä½¿ç”¨MJCFæ–‡ä»¶
```bash
python 29dof_pkl_to_npz_multiple.py \
  --pkl-dir ./test_retarget_npz2pkl \
  --output-dir ./npz_output \
  --mjcf ./model.xml \
  --include-base
```

## âš ï¸ **æ³¨æ„äº‹é¡¹**

1. **æ–‡ä»¶å‘½å**ï¼šNPZæ–‡ä»¶åä¸PKLæ–‡ä»¶åç›¸åŒï¼ˆä»…æ‰©å±•åä¸åŒï¼‰
2. **ç›®å½•æƒé™**ï¼šç¡®ä¿å¯¹è¾“å‡ºç›®å½•æœ‰å†™æƒé™
3. **å†…å­˜ä½¿ç”¨**ï¼šå¤§æ–‡ä»¶æ‰¹é‡å¤„ç†æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨
4. **é”™è¯¯å¤„ç†**ï¼šå•ä¸ªæ–‡ä»¶å¤±è´¥ä¸ä¼šå½±å“å…¶ä»–æ–‡ä»¶çš„å¤„ç†

## ğŸ‰ **ä¼˜åŠ¿**

- **é«˜æ•ˆ**ï¼šæ™ºèƒ½è·³è¿‡å·²å­˜åœ¨æ–‡ä»¶ï¼Œé¿å…é‡å¤å·¥ä½œ
- **å¯é **ï¼šå®Œå…¨åŸºäºåŸå§‹ä»£ç ï¼Œä¿è¯è½¬æ¢è´¨é‡
- **çµæ´»**ï¼šæ”¯æŒæ‰€æœ‰åŸå§‹å‚æ•°å’ŒåŠŸèƒ½
- **ç›´è§‚**ï¼šè¯¦ç»†çš„è¿›åº¦æ˜¾ç¤ºå’Œç»Ÿè®¡æŠ¥å‘Š

